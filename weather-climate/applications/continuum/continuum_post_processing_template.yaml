tosca_definitions_version: alien_dsl_2_0_0

metadata:
  template_name: ContinuumPostProcessTemplate
  template_version: 0.1.0-SNAPSHOT
  template_author: lexis

description: Continuum Post processing template

imports:
  - yorc-types:1.1.0
  - tosca-normative-types:1.0.0-ALIEN20
  - docker-types:3.0.0
  - alien-base-types:3.0.0
  - ddi-types:0.1.2
  - org.ystia.docker.containers.docker.generic:3.0.0-SNAPSHOT
  - org.ystia.docker.ansible:3.0.0-SNAPSHOT
  - org.lexis.common.datatransfer:0.1.2-SNAPSHOT
  - org.lexis.weather.wps:0.1.1-SNAPSHOT
  - org.lexis.weather.continuum:0.1.0
  - org.lexis.weather.webdrops:0.1.0

topology_template:
  inputs:
    token:
      type: string
      required: true
      description: "Access token"
    preprocessing_start_date:
      type: string
      description: Download GFS files from this date, format YYYYMMDDHH
      required: true
    postprocessing_run_date:
      type: string
      description: Continuum run date, format YYYY-MM-DD HH:MM
      required: true
    postprocessing_dataset_wrf_results_path:
      type: string
      description: WRF results dataset path in DDI
      default: "project/proj2bdfd9ccf5a78c3ec68ee9e1d90d2c1c/ff1ec282-38fe-11eb-9717-0050568fc9b5"
      required: false
    postprocessing_dataset_hyde_static_data_path:
      type: string
      description: Hyde static data dataset path in DDI
      default: "project/proj2bdfd9ccf5a78c3ec68ee9e1d90d2c1c/febce6f0-3586-11eb-b264-0050568fcecc"
      required: false
    postprocessing_dataset_hmc_static_data_path:
      type: string
      description: HMC static data dataset path in DDI
      default: "project/proj2bdfd9ccf5a78c3ec68ee9e1d90d2c1c/0c82a142-3589-11eb-b264-0050568fcecc"
      required: false
    postprocessing_hyde_image:
      type: string
      description: Hyde post-processing container repository path 
      default: "laurentg/fp_framework_hyde:1.0.4"
    postprocessing_hmc_image:
      type: string
      description: HMC post-processing container repository path
      default: "laurentg/fp_framework_hmc:1.0.4"
    postprocessing_ddi_path:
      type: string
      description: "Path where to transfer the post-processing results in DDI"
      default: "project/proj2bdfd9ccf5a78c3ec68ee9e1d90d2c1c"
  node_templates:
    PublicNet:
      type: tosca.nodes.Network
      properties:
        ip_version: 4
    ContinuumVM:
      type: tosca.nodes.Compute
      requirements:
        - networkPublicNetConnection:
            type_requirement: network
            node: PublicNet
            capability: tosca.capabilities.Connectivity
            relationship: tosca.relationships.Network
      capabilities:
        host:
          properties:
            num_cpus: 10
        scalable:
          properties:
            min_instances: 1
            max_instances: 1
            default_instances: 1
        endpoint:
          properties:
            secure: true
            protocol: tcp
            network_name: PRIVATE
            initiator: source
    GetDDIAccess:
      type: org.ddi.nodes.DDIAccess
      requirements:
        - hostedOnComputeHost:
            type_requirement: os
            node: ContinuumVM
            capability: tosca.capabilities.OperatingSystem
            relationship: org.ddi.relationships.SameSite
    DDIToCloudWRFJob:
      type: org.ddi.nodes.DDIToCloudJob
      properties:
        token: { get_input: token }
        ddi_dataset_path: { get_input: postprocessing_dataset_wrf_results_path }
        cloud_staging_area_directory_path: "continuum_postprocessing_wrf"
        timestamp_cloud_staging_area_directory: true
    MountWRFDataset:
      type: org.lexis.datatransfer.nodes.SSHMountStagingAreaDataset
      properties:
        token: { get_input: token }
        mount_point_directory: "/mnt/cloud_staging_area/postprocess"
      requirements:
        - ddi_access:
            type_requirement: ddi_access
            node: GetDDIAccess
            capability: org.ddi.capabilities.DDIAccess
            relationship: org.ddi.relationships.DDIAccessProvider
        - data_transfer:
            type_requirement: data_transfer
            node: DDIToCloudWRFJob
            capability: org.ddi.capabilities.DataTransferCloud
            relationship: org.ddi.relationships.CloudAreaDatasetProvider
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    FindWRFiles:
      type: org.lexis.datatransfer.nodes.FindFilesInStagingAreaDirectory
      properties:
        patterns: ["auxhist*"]
      requirements:
        - cloud_area_directory_provider:
            type_requirement: cloud_area_directory_provider
            node: MountWRFDataset
            capability: org.ddi.capabilities.CloudAreaDirectoryProvider
            relationship: org.ddi.relationships.CloudAreaDirectoryProvider
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    MoveWRFFiles:
      type: org.lexis.datatransfer.nodes.MoveFilesFromProvider
      properties:
        destination_directory: "/continuum/datasets_hyde/dynamic_data"
      requirements:
        - files_provider:
            type_requirement: files_provider
            node: FindWRFiles
            capability: org.lexis.datatransfer.capabilities.FilesProvider
            relationship: org.lexis.datatransfer.relationships.FilesProvider
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    DDIToCloudHydeStaticDataJob:
      type: org.ddi.nodes.DDIToCloudJob
      properties:
        token: { get_input: token }
        ddi_dataset_path: { get_input: postprocessing_dataset_hyde_static_data_path }
        cloud_staging_area_directory_path: "continuum_postprocessing_hyde"
        timestamp_cloud_staging_area_directory: true
    MountHydeDataset:
      type: org.lexis.datatransfer.nodes.SSHMountStagingAreaDataset
      properties:
        token: { get_input: token }
        mount_point_directory: "/mnt/cloud_staging_area/postprocess_hyde"
      requirements:
        - ddi_access:
            type_requirement: ddi_access
            node: GetDDIAccess
            capability: org.ddi.capabilities.DDIAccess
            relationship: org.ddi.relationships.DDIAccessProvider
        - data_transfer:
            type_requirement: data_transfer
            node: DDIToCloudHydeStaticDataJob
            capability: org.ddi.capabilities.DataTransferCloud
            relationship: org.ddi.relationships.CloudAreaDatasetProvider
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    FindHydeStaticDataFiles:
      type: org.lexis.datatransfer.nodes.FindFilesInStagingAreaDirectory
      properties:
        patterns:
          - liguria
          - marche
      requirements:
        - cloud_area_directory_provider:
            type_requirement: cloud_area_directory_provider
            node: MountHydeDataset
            capability: org.ddi.capabilities.CloudAreaDirectoryProvider
            relationship: org.ddi.relationships.CloudAreaDirectoryProvider
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    MoveHydeStaticDataFiles:
      type: org.lexis.datatransfer.nodes.MoveFilesFromProvider
      properties:
        destination_directory: "/continuum/datasets_hyde/static_data"
      requirements:
        - files_provider:
            type_requirement: files_provider
            node: FindHydeStaticDataFiles
            capability: org.lexis.datatransfer.capabilities.FilesProvider
            relationship: org.lexis.datatransfer.relationships.FilesProvider
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    DDIToCloudHMCStaticDataJob:
      type: org.ddi.nodes.DDIToCloudJob
      properties:
        token: { get_input: token }
        ddi_dataset_path: { get_input: postprocessing_dataset_hmc_static_data_path }
        cloud_staging_area_directory_path: "continuum_postprocessing_hmc"
        timestamp_cloud_staging_area_directory: true
    MountHMCDataset:
      type: org.lexis.datatransfer.nodes.SSHMountStagingAreaDataset
      properties:
        token: { get_input: token }
        mount_point_directory: "/mnt/cloud_staging_area/postprocess_hmc"
      requirements:
        - ddi_access:
            type_requirement: ddi_access
            node: GetDDIAccess
            capability: org.ddi.capabilities.DDIAccess
            relationship: org.ddi.relationships.DDIAccessProvider
        - data_transfer:
            type_requirement: data_transfer
            node: DDIToCloudHMCStaticDataJob
            capability: org.ddi.capabilities.DataTransferCloud
            relationship: org.ddi.relationships.CloudAreaDatasetProvider
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    FindHMCStaticDataFiles:
      type: org.lexis.datatransfer.nodes.FindFilesInStagingAreaDirectory
      properties:
        patterns:
          - gridded
          - point
      requirements:
        - cloud_area_directory_provider:
            type_requirement: cloud_area_directory_provider
            node: MountHMCDataset
            capability: org.ddi.capabilities.CloudAreaDirectoryProvider
            relationship: org.ddi.relationships.CloudAreaDirectoryProvider
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    MoveHMCStaticDataFiles:
      type: org.lexis.datatransfer.nodes.MoveFilesFromProvider
      properties:
        destination_directory: "/continuum/datasets_hmc/static_data"
      requirements:
        - files_provider:
            type_requirement: files_provider
            node: FindHMCStaticDataFiles
            capability: org.lexis.datatransfer.capabilities.FilesProvider
            relationship: org.lexis.datatransfer.relationships.FilesProvider
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    Docker:
      type: org.ystia.docker.ansible.nodes.Docker
      requirements:
        - hostedOnVirtualMachineHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    CreatePostProcessHydeDirs:
      type: org.lexis.datatransfer.nodes.CreateDirectories
      properties:
        directories:
          - continuum/datasets_hyde/static_data
          - /continuum/datasets_hyde/dynamic_data
          - /continuum/datasets_hyde/docker_data/marche
          - /continuum/datasets_hyde/docker_data/liguria
      requirements:
        - hostedOnVirtualMachineHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    CreatePostProcessHMCDirs:
      type: org.lexis.datatransfer.nodes.CreateDirectories
      properties:
        directories:
          - /continuum/datasets_hmc/static_data
          - /continuum/datasets_hmc/static_data
          - /continuum/datasets_hmc/dynamic_data/restart/marche
          - /continuum/datasets_hmc/dynamic_data/source/marche
          - /continuum/datasets_hmc/dynamic_data/destination/marche
          - /continuum/datasets_hmc/dynamic_data/restart/liguria
          - /continuum/datasets_hmc/dynamic_data/source/liguria
          - /continuum/datasets_hmc/dynamic_data/destination/liguria
      requirements:
        - hostedOnVirtualMachineHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    Webdrops:
      type: org.lexis.nodes.Webdrops
      properties:
        start_date: {get_input: preprocessing_start_date}
        download_type: "CONTINUUM"
        destination: "/continuum/datasets_hyde/dynamic_data"
        auth_url: "https://testauth.cimafoundation.org/auth/realms/webdrops/protocol/openid-connect/token"
        url: "http://webdrops.cimafoundation.org/app/"
      requirements:
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    Continuum_Hyde_marche:
      type: org.ystia.docker.containers.docker.generic.nodes.GenericContainer
      metadata:
        task: postprocessing
      properties:
        auto_remove: false
        cleanup: false
        detach: false
        image: {get_input: postprocessing_hyde_image}
        keep_volumes: true
        restart_policy: no
        cpu_share: 1.0
        workdir: "/home/fp/fp_entrypoint/"
        volumes:
          - "/continuum/datasets_hyde/static_data/marche:/home/fp/fp_mount/datasets_hyde/static"
          - "/continuum/datasets_hyde/dynamic_data/:/home/fp/fp_mount/datasets_hyde/dynamic_raw"
          - "/continuum/datasets_hyde/docker_data/marche:/home/fp/fp_mount/datasets_hyde/dynamic_processed"
        docker_env_vars: {concat: ["{\"RUN_TIME_NOW\": \"", get_input: postprocessing_run_date, "\",\"APP_MAIN\":\"fp_docker_entrypoint_app_main_hyde.py\",\"APP_CONFIG\":\"fp_docker_entrypoint_app_configuration_hyde.json\",\"TARGET_DATA_STATIC\": \"/home/fp/fp_mount/datasets_hyde/static/\",\"TARGET_DATA_DYNAMIC_RAW\": \"/home/fp/fp_mount/datasets_hyde/dynamic_raw/\",\"TARGET_DATA_DYNAMIC_PROCESSED\": \"/home/fp/fp_mount/datasets_hyde/dynamic_processed/\",\"RUN_TIME_STEPS_OBS\": \"36\",\"RUN_TIME_STEPS_FOR\": \"24\",\"RUN_NAME\": \"fp_hyde_run\",\"RUN_DOMAIN\": \"marche\",\"RUN_ENS\": \"false\"}"]}
      requirements:
        - hostedOnContainerRuntimeDockerHost:
            type_requirement: host
            node: Docker
            capability: org.alien4cloud.extended.container.capabilities.ApplicationHost
            relationship: org.alien4cloud.extended.container.relationships.HostedOnContainerRuntime
    Continuum_Hyde_liguria:
      type: org.ystia.docker.containers.docker.generic.nodes.GenericContainer
      metadata:
        task: postprocessing
      properties:
        auto_remove: false
        cleanup: false
        detach: false
        image: {get_input: postprocessing_hyde_image}
        keep_volumes: true
        restart_policy: no
        cpu_share: 1.0
        workdir: "/home/fp/fp_entrypoint/"
        volumes:
          - "/continuum/datasets_hyde/static_data/liguria:/home/fp/fp_mount/datasets_hyde/static"
          - "/continuum/datasets_hyde/dynamic_data/:/home/fp/fp_mount/datasets_hyde/dynamic_raw"
          - "/continuum/datasets_hyde/docker_data/liguria:/home/fp/fp_mount/datasets_hyde/dynamic_processed"
        docker_env_vars: {concat: ["{\"RUN_TIME_NOW\": \"", get_input: postprocessing_run_date, "\",\"APP_MAIN\":\"fp_docker_entrypoint_app_main_hyde.py\",\"APP_CONFIG\":\"fp_docker_entrypoint_app_configuration_hyde.json\",\"TARGET_DATA_STATIC\": \"/home/fp/fp_mount/datasets_hyde/static/\",\"TARGET_DATA_DYNAMIC_RAW\": \"/home/fp/fp_mount/datasets_hyde/dynamic_raw/\",\"TARGET_DATA_DYNAMIC_PROCESSED\": \"/home/fp/fp_mount/datasets_hyde/dynamic_processed/\",\"RUN_TIME_STEPS_OBS\": \"36\",\"RUN_TIME_STEPS_FOR\": \"24\",\"RUN_NAME\": \"fp_hyde_run\",\"RUN_DOMAIN\": \"liguria\",\"RUN_ENS\": \"false\"}"]}
      requirements:
        - hostedOnContainerRuntimeDockerHost:
            type_requirement: host
            node: Docker
            capability: org.alien4cloud.extended.container.capabilities.ApplicationHost
            relationship: org.alien4cloud.extended.container.relationships.HostedOnContainerRuntime
    Move_Hyde_Results:
      type: org.lexis.datatransfer.nodes.MoveFile
      properties:
        source_file: "/continuum/datasets_hyde/docker_data/*"
        destination: "/continuum/datasets_hmc/dynamic_data/source/"
      requirements:
        - hostedOnVirtualMachineHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    Continuum_HMC_marche:
      type: org.ystia.docker.containers.docker.generic.nodes.GenericContainer
      properties:
        auto_remove: false
        cleanup: false
        detach: false
        image: {get_input: postprocessing_hmc_image}
        keep_volumes: true
        restart_policy: no
        cpu_share: 1.0
        workdir: "/home/fp/fp_entrypoint/"
        volumes:
          - "/continuum/datasets_hmc/static_data/gridded/marche:/home/fp/fp_mount/datasets_hmc/static/gridded"
          - "/continuum/datasets_hmc/static_data/point/marche:/home/fp/fp_mount/datasets_hmc/static/point"
          - "/continuum/datasets_hmc/dynamic_data/restart/marche:/home/fp/fp_mount/datasets_hmc/dynamic_restart"
          - "/continuum/datasets_hmc/dynamic_data/source/marche:/home/fp/fp_mount/datasets_hmc/dynamic_source"
          - "/continuum/datasets_hmc/dynamic_data/destination/marche/:/home/fp/fp_mount/datasets_hmc/dynamic_destination"
        docker_env_vars: {concat: ["{\"RUN_TIME_NOW\": \"", get_input: postprocessing_run_date, "\",\"APP_MAIN\":\"fp_docker_entrypoint_app_main_hmc.py\",\"APP_CONFIG\":\"fp_docker_entrypoint_app_configuration_hmc.json\",\"TARGET_DATA_STATIC_GRIDDED\": \"/home/fp/fp_mount/datasets_hmc/static/gridded/\",\"TARGET_DATA_STATIC_POINT\": \"/home/fp/fp_mount/datasets_hmc/static/point/\",\"TARGET_DATA_DYNAMIC_RESTART\": \"/home/fp/fp_mount/datasets_hmc/dynamic_restart/\",\"TARGET_DATA_DYNAMIC_SOURCE\": \"/home/fp/fp_mount/datasets_hmc/dynamic_source/\",\"TARGET_DATA_DYNAMIC_DESTINATION\": \"/home/fp/fp_mount/datasets_hmc/dynamic_destination/\",\"RUN_TIME_STEPS_OBS\": \"24\",\"RUN_TIME_STEPS_FOR\": \"24\",\"RUN_NAME\": \"fp_hmc_run\",\"RUN_DOMAIN\": \"marche\",\"RUN_ENS\": \"false\"}"]}
      requirements:
        - hostedOnContainerRuntimeDockerHost:
            type_requirement: host
            node: Docker
            capability: org.alien4cloud.extended.container.capabilities.ApplicationHost
            relationship: org.alien4cloud.extended.container.relationships.HostedOnContainerRuntime
    Continuum_HMC_liguria:
      type: org.ystia.docker.containers.docker.generic.nodes.GenericContainer
      properties:
        auto_remove: false
        cleanup: false
        detach: false
        image: {get_input: postprocessing_hmc_image}
        keep_volumes: true
        restart_policy: no
        cpu_share: 1.0
        workdir: "/home/fp/fp_entrypoint/"
        volumes:
          - "/continuum/datasets_hmc/static_data/gridded/liguria:/home/fp/fp_mount/datasets_hmc/static/gridded"
          - "/continuum/datasets_hmc/static_data/point/liguria:/home/fp/fp_mount/datasets_hmc/static/point"
          - "/continuum/datasets_hmc/dynamic_data/restart/liguria:/home/fp/fp_mount/datasets_hmc/dynamic_restart"
          - "/continuum/datasets_hmc/dynamic_data/source/liguria:/home/fp/fp_mount/datasets_hmc/dynamic_source"
          - "/continuum/datasets_hmc/dynamic_data/destination/liguria/:/home/fp/fp_mount/datasets_hmc/dynamic_destination"
        docker_env_vars: {concat: ["{\"RUN_TIME_NOW\": \"", get_input: postprocessing_run_date, "\",\"APP_MAIN\":\"fp_docker_entrypoint_app_main_hmc.py\",\"APP_CONFIG\":\"fp_docker_entrypoint_app_configuration_hmc.json\",\"TARGET_DATA_STATIC_GRIDDED\": \"/home/fp/fp_mount/datasets_hmc/static/gridded/\",\"TARGET_DATA_STATIC_POINT\": \"/home/fp/fp_mount/datasets_hmc/static/point/\",\"TARGET_DATA_DYNAMIC_RESTART\": \"/home/fp/fp_mount/datasets_hmc/dynamic_restart/\",\"TARGET_DATA_DYNAMIC_SOURCE\": \"/home/fp/fp_mount/datasets_hmc/dynamic_source/\",\"TARGET_DATA_DYNAMIC_DESTINATION\": \"/home/fp/fp_mount/datasets_hmc/dynamic_destination/\",\"RUN_TIME_STEPS_OBS\": \"24\",\"RUN_TIME_STEPS_FOR\": \"24\",\"RUN_NAME\": \"fp_hmc_run\",\"RUN_DOMAIN\": \"liguria\",\"RUN_ENS\": \"false\"}"]}
      requirements:
        - hostedOnContainerRuntimeDockerHost:
            type_requirement: host
            node: Docker
            capability: org.alien4cloud.extended.container.capabilities.ApplicationHost
            relationship: org.alien4cloud.extended.container.relationships.HostedOnContainerRuntime
    CreateStagingAreaResultDir:
      type: org.lexis.datatransfer.nodes.CreateStagingAreaDirectory
      properties:
        directory: "continuum_results"
      requirements:
        - mountedCloudStagingArea:
            type_requirement: mounted_staging_area
            node: MountWRFDataset
            capability: org.lexis.datatransfer.capabilities.MountedStagingAreaAccess
            relationship: org.lexis.datatransfer.relationships.MountedCloudStagingArea
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    MoveContinuumResults:
      type: org.lexis.datatransfer.nodes.MoveToStagingAreaDirectory
      properties:
        source_directory: "/continuum/datasets_hmc/dynamic_data/destination/"
      requirements:
        - staging_area_directory:
            type_requirement: cloud_area_directory_provider
            node: CreateStagingAreaResultDir
            capability: org.ddi.capabilities.CloudAreaDirectoryProvider
            relationship: org.ddi.relationships.CloudAreaDirectoryProvider
        - hostedOnComputeHost:
            type_requirement: host
            node: ContinuumVM
            capability: tosca.capabilities.Container
            relationship: tosca.relationships.HostedOn
    CloudToDDIJob:
      type: org.ddi.nodes.CloudToDDIJob
      properties:
        metadata: {concat: ["{\"creator\": [\"Continuum workflow\"], \"contributor\": [\"Continuum workflow\"], \"publisher\": [\"Continuum workflow\"], \"resourceType\": \"Workflow result\", \"title\": \"Continuum Workflow result - ", get_input: postprocessing_run_date, "\"}"]}
        token: { get_input: token }
        ddi_path: { get_input: postprocessing_ddi_path }
      requirements:
        - cloud_area_directory_provider:
            type_requirement: cloud_area_directory_provider
            node: CreateStagingAreaResultDir
            capability: org.ddi.capabilities.CloudAreaDirectoryProvider
            relationship: org.ddi.relationships.CloudAreaDirectoryProvider
    DeleteCloudWRFDataJob:
      type: org.ddi.nodes.DeleteCloudDataJob
      properties:
        token: { get_input: token }
      requirements:
        - cloud_area_dataset_provider:
            type_requirement: cloud_area_dataset_provider
            node: DDIToCloudWRFJob
            capability: org.ddi.capabilities.DataTransferCloud
            relationship: org.ddi.relationships.CloudAreaDatasetProvider
    DeleteCloudHydeStaticDataJob:
      type: org.ddi.nodes.DeleteCloudDataJob
      properties:
        token: { get_input: token }
      requirements:
        - cloud_area_dataset_provider:
            type_requirement: cloud_area_dataset_provider
            node: DDIToCloudHydeStaticDataJob
            capability: org.ddi.capabilities.DataTransferCloud
            relationship: org.ddi.relationships.CloudAreaDatasetProvider
    DeleteCloudHMCStaticDataJob:
      type: org.ddi.nodes.DeleteCloudDataJob
      properties:
        token: { get_input: token }
      requirements:
        - cloud_area_dataset_provider:
            type_requirement: cloud_area_dataset_provider
            node: DDIToCloudHMCStaticDataJob
            capability: org.ddi.capabilities.DataTransferCloud
            relationship: org.ddi.relationships.CloudAreaDatasetProvider
  outputs:
    ddi_post_process_results:
      description: DDI path to Continuum post-processing results
      value: { get_attribute: [ CloudToDDIJob, destination_directory_path ] }
  workflows:
    install:
      steps:
        Network_install:
          target: PublicNet
          activities:
            - delegate: install
    uninstall:
      steps:
        Compute_uninstall:
          target: ContinuumVM
          activities:
            - delegate: uninstall
          on_success:
            - Network_uninstall
        Network_uninstall:
          target: PublicNet
          activities:
            - delegate: uninstall
    Run:
      steps:
        Compute_install:
          target: ContinuumVM
          activities:
            - delegate: install
          on_success:
            - Docker_create
        Docker_create:
          target: Docker
          activities:
            - call_operation: Standard.create
          on_success:
            - Docker_configure
        Docker_configure:
          target: Docker
          activities:
            - call_operation: Standard.configure
          on_success:
            - Docker_start
        Docker_start:
          target: Docker
          activities:
            - call_operation: Standard.start
          on_success:
            - Docker_started
        Docker_started:
          target: Docker
          activities:
            - set_state: started
          on_success:
            - GetDDIAccess_start
            - CreatePostProcessHydeDirs_start
            - CreatePostProcessHMCDirs_start
        CreatePostProcessHydeDirs_start:
          target: CreatePostProcessHydeDirs
          activities:
            - call_operation: Standard.start
          on_success:
            - CreatePostProcessHydeDirs_started
        CreatePostProcessHydeDirs_started:
          target: CreatePostProcessHydeDirs
          activities:
            - set_state: started
          on_success:
            - DDIToCloudWRFJob_create
            - DDIToCloudHydeStaticDataJob_create
            - Webdrops_start
        GetDDIAccess_start:
          target: GetDDIAccess
          activities:
            - call_operation: Standard.start
          on_success:
            - GetDDIAccess_started
        GetDDIAccess_started:
          target: GetDDIAccess
          activities:
            - set_state: started
          on_success:
            - DDIToCloudWRFJob_create
            - DDIToCloudHydeStaticDataJob_create
            - DDIToCloudHMCStaticDataJob_create
        DDIToCloudWRFJob_create:
          target: DDIToCloudWRFJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: Standard.create
          on_success:
            - DDIToCloudWRFJob_submit
        DDIToCloudWRFJob_submit:
          target: DDIToCloudWRFJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.submit
          on_success:
            - DDIToCloudWRFJob_submitted
        DDIToCloudWRFJob_submitted:
          target: DDIToCloudWRFJob
          activities:
            - set_state: submitted
          on_success:
            - DDIToCloudWRFJob_run
        DDIToCloudWRFJob_run:
          target: DDIToCloudWRFJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.run
          on_success:
            - DDIToCloudWRFJob_executed
        DDIToCloudWRFJob_executed:
          target: DDIToCloudWRFJob
          activities:
            - set_state: executed
          on_success:
            - MountWRFDataset_create
        MountWRFDataset_create:
          target: MountWRFDataset
          activities:
            - call_operation: Standard.create
          on_success:
            - MountWRFDataset_created
            # Added to be started after MountWRFDataset_create and avoid potential
            # yum issues
            - MountHydeDataset_create
            - MountHMCDataset_create
        MountWRFDataset_created:
          target: MountWRFDataset
          activities:
            - set_state: created
          on_success:
            - MountWRFDataset_start
        MountWRFDataset_start:
          target: MountWRFDataset
          activities:
            - call_operation: Standard.start
          on_success:
            - MountWRFDataset_started
        MountWRFDataset_started:
          target: MountWRFDataset
          activities:
            - set_state: started
          on_success:
            - FindWRFiles_start
        FindWRFiles_start:
          target: FindWRFiles
          activities:
            - call_operation: Standard.start
          on_success:
            - FindWRFiles_started
        FindWRFiles_started:
          target: FindWRFiles
          activities:
            - set_state: started
          on_success:
            - MoveWRFFiles_start
        MoveWRFFiles_start:
          target: MoveWRFFiles
          activities:
            - call_operation: Standard.start
          on_success:
            - MoveWRFFiles_started
        MoveWRFFiles_started:
          target: MoveWRFFiles
          activities:
            - set_state: started
          on_success:
            - Continuum_Hyde_marche_create
        DDIToCloudHydeStaticDataJob_create:
          target: DDIToCloudHydeStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: Standard.create
          on_success:
            - DDIToCloudHydeStaticDataJob_submit
        DDIToCloudHydeStaticDataJob_submit:
          target: DDIToCloudHydeStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.submit
          on_success:
            - DDIToCloudHydeStaticDataJob_submitted
        DDIToCloudHydeStaticDataJob_submitted:
          target: DDIToCloudHydeStaticDataJob
          activities:
            - set_state: submitted
          on_success:
            - DDIToCloudHydeStaticDataJob_run
        DDIToCloudHydeStaticDataJob_run:
          target: DDIToCloudHydeStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.run
          on_success:
            - DDIToCloudHydeStaticDataJob_executed
        DDIToCloudHydeStaticDataJob_executed:
          target: DDIToCloudHydeStaticDataJob
          activities:
            - set_state: executed
          on_success:
            - MountHydeDataset_create
        MountHydeDataset_create:
          target: MountHydeDataset
          activities:
            - call_operation: Standard.create
          on_success:
            - MountHydeDataset_created
        MountHydeDataset_created:
          target: MountHydeDataset
          activities:
            - set_state: created
          on_success:
            - MountHydeDataset_start
        MountHydeDataset_start:
          target: MountHydeDataset
          activities:
            - call_operation: Standard.start
          on_success:
            - MountHydeDataset_started
        MountHydeDataset_started:
          target: MountHydeDataset
          activities:
            - set_state: started
          on_success:
            - FindHydeStaticDataFiles_start
        FindHydeStaticDataFiles_start:
          target: FindHydeStaticDataFiles
          activities:
            - call_operation: Standard.start
          on_success:
            - FindHydeStaticDataFiles_started
        FindHydeStaticDataFiles_started:
          target: FindHydeStaticDataFiles
          activities:
            - set_state: started
          on_success:
            - MoveHydeStaticDataFiles_start
        MoveHydeStaticDataFiles_start:
          target: MoveHydeStaticDataFiles
          activities:
            - call_operation: Standard.start
          on_success:
            - MoveHydeStaticDataFiles_started
        MoveHydeStaticDataFiles_started:
          target: MoveHydeStaticDataFiles
          activities:
            - set_state: started
          on_success:
            - Continuum_Hyde_marche_create
        CreatePostProcessHMCDirs_start:
          target: CreatePostProcessHMCDirs
          activities:
            - call_operation: Standard.start
          on_success:
            - CreatePostProcessHMCDirs_started
        CreatePostProcessHMCDirs_started:
          target: CreatePostProcessHMCDirs
          activities:
            - set_state: started
          on_success:
            - DDIToCloudHMCStaticDataJob_create
        DDIToCloudHMCStaticDataJob_create:
          target: DDIToCloudHMCStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: Standard.create
          on_success:
            - DDIToCloudHMCStaticDataJob_submit
        DDIToCloudHMCStaticDataJob_submit:
          target: DDIToCloudHMCStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.submit
          on_success:
            - DDIToCloudHMCStaticDataJob_submitted
        DDIToCloudHMCStaticDataJob_submitted:
          target: DDIToCloudHMCStaticDataJob
          activities:
            - set_state: submitted
          on_success:
            - DDIToCloudHMCStaticDataJob_run
        DDIToCloudHMCStaticDataJob_run:
          target: DDIToCloudHMCStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.run
          on_success:
            - DDIToCloudHMCStaticDataJob_executed
        DDIToCloudHMCStaticDataJob_executed:
          target: DDIToCloudHMCStaticDataJob
          activities:
            - set_state: executed
          on_success:
            - MountHMCDataset_create
        MountHMCDataset_create:
          target: MountHMCDataset
          activities:
            - call_operation: Standard.create
          on_success:
            - MountHMCDataset_created
        MountHMCDataset_created:
          target: MountHMCDataset
          activities:
            - set_state: created
          on_success:
            - MountHMCDataset_start
        MountHMCDataset_start:
          target: MountHMCDataset
          activities:
            - call_operation: Standard.start
          on_success:
            - MountHMCDataset_started
        MountHMCDataset_started:
          target: MountHMCDataset
          activities:
            - set_state: started
          on_success:
            - FindHMCStaticDataFiles_start
        FindHMCStaticDataFiles_start:
          target: FindHMCStaticDataFiles
          activities:
            - call_operation: Standard.start
          on_success:
            - FindHMCStaticDataFiles_started
        FindHMCStaticDataFiles_started:
          target: FindHMCStaticDataFiles
          activities:
            - set_state: started
          on_success:
            - MoveHMCStaticDataFiles_start
        MoveHMCStaticDataFiles_start:
          target: MoveHMCStaticDataFiles
          activities:
            - call_operation: Standard.start
          on_success:
            - MoveHMCStaticDataFiles_started
        MoveHMCStaticDataFiles_started:
          target: MoveHMCStaticDataFiles
          activities:
            - set_state: started
          on_success:
            - Continuum_HMC_marche_create
            - Continuum_HMC_liguria_create
        Webdrops_start:
          target: Webdrops
          activities:
            - call_operation: Standard.start
          on_success:
            - Webdrops_started
        Webdrops_started:
          target: Webdrops
          activities:
            - set_state: started
          on_success:
            - Continuum_Hyde_marche_create
        Continuum_Hyde_marche_create:
          target: Continuum_Hyde_marche
          activities:
            - call_operation: Standard.create
          on_success:
            - Continuum_Hyde_liguria_create
            - Continuum_Hyde_marche_start
        Continuum_Hyde_marche_start:
          target: Continuum_Hyde_marche
          activities:
            - call_operation: Standard.start
          on_success:
            - Continuum_Hyde_marche_started
        Continuum_Hyde_marche_started:
          target: Continuum_Hyde_marche
          activities:
            - set_state: started
          on_success:
            - Move_Hyde_Results_start
        Continuum_Hyde_liguria_create:
          target: Continuum_Hyde_liguria
          activities:
            - call_operation: Standard.create
          on_success:
            - Continuum_Hyde_liguria_start
        Continuum_Hyde_liguria_start:
          target: Continuum_Hyde_liguria
          activities:
            - call_operation: Standard.start
          on_success:
            - Continuum_Hyde_liguria_started
        Continuum_Hyde_liguria_started:
          target: Continuum_Hyde_liguria
          activities:
            - set_state: started
          on_success:
            - Move_Hyde_Results_start
        Move_Hyde_Results_start:
          target: Move_Hyde_Results
          activities:
            - call_operation: Standard.start
          on_success:
            - Move_Hyde_Results_started
        Move_Hyde_Results_started:
          target: Move_Hyde_Results
          activities:
            - set_state: started
          on_success:
            - Continuum_HMC_marche_create
            - Continuum_HMC_liguria_create
        Continuum_HMC_marche_create:
          target: Continuum_HMC_marche
          activities:
            - call_operation: Standard.create
          on_success:
            - Continuum_HMC_marche_start
        Continuum_HMC_marche_start:
          target: Continuum_HMC_marche
          activities:
            - call_operation: Standard.start
          on_success:
            - Continuum_HMC_marche_started
        Continuum_HMC_marche_started:
          target: Continuum_HMC_marche
          activities:
            - set_state: started
          on_success:
            - CreateStagingAreaResultDir_start
        Continuum_HMC_liguria_create:
          target: Continuum_HMC_liguria
          activities:
            - call_operation: Standard.create
          on_success:
            - Continuum_HMC_liguria_start
        Continuum_HMC_liguria_start:
          target: Continuum_HMC_liguria
          activities:
            - call_operation: Standard.start
          on_success:
            - Continuum_HMC_liguria_started
        Continuum_HMC_liguria_started:
          target: Continuum_HMC_liguria
          activities:
            - set_state: started
          on_success:
            - CreateStagingAreaResultDir_start
        CreateStagingAreaResultDir_start:
          target: CreateStagingAreaResultDir
          activities:
            - call_operation: Standard.start
          on_success:
            - CreateStagingAreaResultDir_started
        CreateStagingAreaResultDir_started:
          target: CreateStagingAreaResultDir
          activities:
            - set_state: started
          on_success:
            - MoveContinuumResults_start
        MoveContinuumResults_start:
          target: MoveContinuumResults
          activities:
            - call_operation: Standard.start
          on_success:
            - MoveContinuumResults_started
        MoveContinuumResults_started:
          target: MoveContinuumResults
          activities:
            - set_state: started
          on_success:
            - CloudToDDIJob_create
        CloudToDDIJob_create:
          target: CloudToDDIJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: Standard.create
          on_success:
            - CloudToDDIJob_submit
        CloudToDDIJob_submit:
          target: CloudToDDIJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.submit
          on_success:
            - CloudToDDIJob_submitted
        CloudToDDIJob_submitted:
          target: CloudToDDIJob
          activities:
            - set_state: submitted
          on_success:
            - CloudToDDIJob_run
        CloudToDDIJob_run:
          target: CloudToDDIJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.run
          on_success:
            - CloudToDDIJob_executed
        CloudToDDIJob_executed:
          target: CloudToDDIJob
          activities:
            - set_state: executed
          on_success:
            - MountWRFDataset_stop
            - MountHydeDataset_stop
            - MountHMCDataset_stop
        MountWRFDataset_stop:
          target: MountWRFDataset
          activities:
            - call_operation: Standard.stop
          on_success:
            - MountWRFDataset_stopped
        MountWRFDataset_stopped:
          target: MountWRFDataset
          activities:
            - set_state: stopped
          on_success:
            - DeleteCloudWRFDataJob_create
        DeleteCloudWRFDataJob_create:
          target: DeleteCloudWRFDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: Standard.create
          on_success:
            - DeleteCloudWRFDataJob_created
        DeleteCloudWRFDataJob_created:
          target: DeleteCloudWRFDataJob
          activities:
            - set_state: created
          on_success:
            - DeleteCloudWRFDataJob_submit
        DeleteCloudWRFDataJob_submit:
          target: DeleteCloudWRFDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.submit
          on_success:
            - DeleteCloudWRFDataJob_submitted
        DeleteCloudWRFDataJob_submitted:
          target: DeleteCloudWRFDataJob
          activities:
            - set_state: submitted
          on_success:
            - DeleteCloudWRFDataJob_run
        DeleteCloudWRFDataJob_run:
          target: DeleteCloudWRFDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.run
          on_success:
            - DeleteCloudWRFDataJob_executed
        DeleteCloudWRFDataJob_executed:
          target: DeleteCloudWRFDataJob
          activities:
            - set_state: executed
          on_success:
            - Compute_uninstall
        MountHydeDataset_stop:
          target: MountHydeDataset
          activities:
            - call_operation: Standard.stop
          on_success:
            - MountHydeDataset_stopped
        MountHydeDataset_stopped:
          target: MountHydeDataset
          activities:
            - set_state: stopped
          on_success:
            - DeleteCloudHydeStaticDataJob_create
        DeleteCloudHydeStaticDataJob_create:
          target: DeleteCloudHydeStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: Standard.create
          on_success:
            - DeleteCloudHydeStaticDataJob_created
        DeleteCloudHydeStaticDataJob_created:
          target: DeleteCloudHydeStaticDataJob
          activities:
            - set_state: created
          on_success:
            - DeleteCloudHydeStaticDataJob_submit
        DeleteCloudHydeStaticDataJob_submit:
          target: DeleteCloudHydeStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.submit
          on_success:
            - DeleteCloudHydeStaticDataJob_submitted
        DeleteCloudHydeStaticDataJob_submitted:
          target: DeleteCloudHydeStaticDataJob
          activities:
            - set_state: submitted
          on_success:
            - DeleteCloudHydeStaticDataJob_run
        DeleteCloudHydeStaticDataJob_run:
          target: DeleteCloudHydeStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.run
          on_success:
            - DeleteCloudHydeStaticDataJob_executed
        DeleteCloudHydeStaticDataJob_executed:
          target: DeleteCloudHydeStaticDataJob
          activities:
            - set_state: executed
          on_success:
            - Compute_uninstall
        MountHMCDataset_stop:
          target: MountHMCDataset
          activities:
            - call_operation: Standard.stop
          on_success:
            - MountHMCDataset_stopped
        MountHMCDataset_stopped:
          target: MountHMCDataset
          activities:
            - set_state: stopped
          on_success:
            - DeleteCloudHMCStaticDataJob_create
        DeleteCloudHMCStaticDataJob_create:
          target: DeleteCloudHMCStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: Standard.create
          on_success:
            - DeleteCloudHMCStaticDataJob_created
        DeleteCloudHMCStaticDataJob_created:
          target: DeleteCloudHMCStaticDataJob
          activities:
            - set_state: created
          on_success:
            - DeleteCloudHMCStaticDataJob_submit
        DeleteCloudHMCStaticDataJob_submit:
          target: DeleteCloudHMCStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.submit
          on_success:
            - DeleteCloudHMCStaticDataJob_submitted
        DeleteCloudHMCStaticDataJob_submitted:
          target: DeleteCloudHMCStaticDataJob
          activities:
            - set_state: submitted
          on_success:
            - DeleteCloudHMCStaticDataJob_run
        DeleteCloudHMCStaticDataJob_run:
          target: DeleteCloudHMCStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.run
          on_success:
            - DeleteCloudHMCStaticDataJob_executed
        DeleteCloudHMCStaticDataJob_executed:
          target: DeleteCloudHMCStaticDataJob
          activities:
            - set_state: executed
          on_success:
            - Compute_uninstall
        Compute_uninstall:
          target: ContinuumVM
          activities:
            - delegate: uninstall
    cleanupRun:
      steps:
        MountWRFDataset_stop:
          target: MountWRFDataset
          activities:
            - call_operation: Standard.stop
          on_success:
            - MountWRFDataset_stopped
        MountWRFDataset_stopped:
          target: MountWRFDataset
          activities:
            - set_state: stopped
          on_success:
            - DeleteCloudWRFDataJob_create
        DeleteCloudWRFDataJob_create:
          target: DeleteCloudWRFDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: Standard.create
          on_success:
            - DeleteCloudWRFDataJob_created
        DeleteCloudWRFDataJob_created:
          target: DeleteCloudWRFDataJob
          activities:
            - set_state: created
          on_success:
            - DeleteCloudWRFDataJob_submit
        DeleteCloudWRFDataJob_submit:
          target: DeleteCloudWRFDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.submit
          on_success:
            - DeleteCloudWRFDataJob_submitted
        DeleteCloudWRFDataJob_submitted:
          target: DeleteCloudWRFDataJob
          activities:
            - set_state: submitted
          on_success:
            - DeleteCloudWRFDataJob_run
        DeleteCloudWRFDataJob_run:
          target: DeleteCloudWRFDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.run
          on_success:
            - DeleteCloudWRFDataJob_executed
        DeleteCloudWRFDataJob_executed:
          target: DeleteCloudWRFDataJob
          activities:
            - set_state: executed
          on_success:
            - Compute_uninstall
        MountHydeDataset_stop:
          target: MountHydeDataset
          activities:
            - call_operation: Standard.stop
          on_success:
            - MountHydeDataset_stopped
        MountHydeDataset_stopped:
          target: MountHydeDataset
          activities:
            - set_state: stopped
          on_success:
            - DeleteCloudHydeStaticDataJob_create
        DeleteCloudHydeStaticDataJob_create:
          target: DeleteCloudHydeStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: Standard.create
          on_success:
            - DeleteCloudHydeStaticDataJob_created
        DeleteCloudHydeStaticDataJob_created:
          target: DeleteCloudHydeStaticDataJob
          activities:
            - set_state: created
          on_success:
            - DeleteCloudHydeStaticDataJob_submit
        DeleteCloudHydeStaticDataJob_submit:
          target: DeleteCloudHydeStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.submit
          on_success:
            - DeleteCloudHydeStaticDataJob_submitted
        DeleteCloudHydeStaticDataJob_submitted:
          target: DeleteCloudHydeStaticDataJob
          activities:
            - set_state: submitted
          on_success:
            - DeleteCloudHydeStaticDataJob_run
        DeleteCloudHydeStaticDataJob_run:
          target: DeleteCloudHydeStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.run
          on_success:
            - DeleteCloudHydeStaticDataJob_executed
        DeleteCloudHydeStaticDataJob_executed:
          target: DeleteCloudHydeStaticDataJob
          activities:
            - set_state: executed
          on_success:
            - Compute_uninstall
        MountHMCDataset_stop:
          target: MountHMCDataset
          activities:
            - call_operation: Standard.stop
          on_success:
            - MountHMCDataset_stopped
        MountHMCDataset_stopped:
          target: MountHMCDataset
          activities:
            - set_state: stopped
          on_success:
            - DeleteCloudHMCStaticDataJob_create
        DeleteCloudHMCStaticDataJob_create:
          target: DeleteCloudHMCStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: Standard.create
          on_success:
            - DeleteCloudHMCStaticDataJob_created
        DeleteCloudHMCStaticDataJob_created:
          target: DeleteCloudHMCStaticDataJob
          activities:
            - set_state: created
          on_success:
            - DeleteCloudHMCStaticDataJob_submit
        DeleteCloudHMCStaticDataJob_submit:
          target: DeleteCloudHMCStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.submit
          on_success:
            - DeleteCloudHMCStaticDataJob_submitted
        DeleteCloudHMCStaticDataJob_submitted:
          target: DeleteCloudHMCStaticDataJob
          activities:
            - set_state: submitted
          on_success:
            - DeleteCloudHMCStaticDataJob_run
        DeleteCloudHMCStaticDataJob_run:
          target: DeleteCloudHMCStaticDataJob
          operation_host: ORCHESTRATOR
          activities:
            - call_operation: tosca.interfaces.node.lifecycle.Runnable.run
          on_success:
            - DeleteCloudHMCStaticDataJob_executed
        DeleteCloudHMCStaticDataJob_executed:
          target: DeleteCloudHMCStaticDataJob
          activities:
            - set_state: executed
          on_success:
            - Compute_uninstall
        Compute_uninstall:
          target: ContinuumVM
          activities:
            - delegate: uninstall
    testComputeUninstall:
      steps:
        Compute_uninstall:
          target: ContinuumVM
          activities:
            - delegate: uninstall
